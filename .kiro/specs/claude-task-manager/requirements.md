# 要件文書

## はじめに

sage（賢者）は、Claude DesktopとClaude Code向けのAIアシスタントプラグインで、タスク管理、優先順位付け、リマインド設定、カレンダー統合を自動化します。システムは個人の作業パターンを学習し、パーソナライズされたタスク整理とスケジューリング推奨を提供します。

このプラグインは最初にMercariのエンジニア（個人貢献者およびエンジニアリングマネージャー）をターゲットとし、将来的には全社展開を計画しています。Apple Reminders、Notion、Google Calendarと統合し、プラットフォーム間でシームレスなタスク管理を提供します。

## 要件

### 要件1: 初期セットアップと設定

**ユーザーストーリー:** 新規ユーザーとして、3分以内に初期セットアップを完了したい。複雑な設定なしにすぐにAIアシスタントを使い始められるようにするため。

#### 受け入れ基準

1. ユーザーが初回プラグインを起動したとき、システムは設定ファイルの存在を確認すること
2. 設定ファイルが存在しない場合、システムはセットアップが必要であることを表示すること
3. ユーザーがセットアップウィザードを開始したとき、システムは最大10問の質問を提示すること
4. ユーザーがすべてのセットアップ質問を完了したとき、システムは30秒以内に設定ファイルを生成すること
5. 設定が保存されたとき、システムは~/.sage/config.jsonに保存すること
6. セットアップが完了したとき、システムはユーザーに設定成功を確認すること

### 要件2: タスク分析と優先順位付け

**ユーザーストーリー:** 忙しいエンジニアとして、システムに自動的にタスクを分析して優先順位を割り当ててもらいたい。最も重要な作業に最初に集中できるようにするため。

#### 受け入れ基準

1. ユーザーがタスクリストを提供したとき、システムは各タスクの優先度レベルを分析すること
2. 優先度を分析するとき、システムは設定されたルールに基づいてP0、P1、P2、P3を割り当てること
3. タスクに期限キーワードが含まれているとき、システムは緊急度に基づいて優先順位を付けること
4. タスクにユーザーのマネージャーが言及されているとき、システムはより高い優先度を考慮すること
5. 優先度が決定されたとき、システムは割り当ての理由を提供すること
6. タスクが分析されたとき、システムは完了時間を分単位で見積もること

### 要件3: 時間見積もりとスケジューリング

**ユーザーストーリー:** ユーザーとして、システムにタスクの所要時間を見積もってもらい、いつ実行するかを提案してもらいたい。効果的に一日を計画できるようにするため。

#### 受け入れ基準

1. タスクを分析するとき、システムはキーワードに基づいて完了時間を見積もること
2. 時間を見積もるとき、システムは設定された時間マッピング（簡単：25分、複雑：75分など）を使用すること
3. 利用可能な時間枠を見つけるとき、システムはユーザーのカレンダーを確認すること
4. カレンダーを確認するとき、システムは設定された勤務時間を尊重すること
5. 時間枠を提案するとき、システムは深い作業日と会議の多い日を考慮すること
6. 競合がない場合、システムは理由付きで最適な時間枠を提案すること

### 要件4: 関係者の識別

**ユーザーストーリー:** チームメンバーとして、システムにタスクに関わる他の人を識別してもらいたい。適切な人と効果的に連携できるようにするため。

#### 受け入れ基準

1. タスクを分析するとき、システムはタスク内容から関係者名を抽出すること
2. 関係者を抽出するとき、システムは設定されたチームメンバーを認識すること
3. @メンションを見つけたとき、システムはそれらを関係者として含めること
4. マネージャーキーワードが検出されたとき、システムはマネージャーの関与をフラグ付けすること
5. 関係者が識別されたとき、システムは関連する人のリストを返すこと

### 要件5: リマインド管理

**ユーザーストーリー:** 忘れっぽい人として、システムにタスクの適切なリマインドを設定してもらいたい。重要な期限を逃さないようにするため。

#### 受け入れ基準

1. タスクに期限があるとき、システムは適切なリマインド時間を提案すること
2. 期限が7日以内のとき、システムはApple Remindersを作成すること
3. 期限が8日以上先のとき、システムはNotionエントリを作成すること
4. リマインドを設定するとき、システムは設定されたリマインド設定を使用すること
5. リマインドが作成されたとき、システムは作成成功を確認すること
6. リマインド作成が失敗したとき、システムはエラー詳細を提供すること

### 要件6: カレンダー統合

**ユーザーストーリー:** カレンダーに依存する作業者として、システムに私のスケジュールを理解してもらい、現実的な時間枠を提案してもらいたい。既存のコミットメントの周りでタスクを計画できるようにするため。

#### 受け入れ基準

1. 空き状況を確認するとき、システムはGoogle Calendarに接続すること
2. カレンダーを分析するとき、システムは空いている時間枠を識別すること
3. 時間枠を評価するとき、システムは設定された深い作業日を考慮すること
4. 会議の多い日が設定されているとき、システムはそれらの枠をあまり適さないとマークすること
5. 競合が検出されたとき、システムはその時間帯を除外すること
6. 枠を提案するとき、システムは適合性でランク付けすること（優秀/良好/許容可能）

### 要件7: クロスプラットフォーム互換性

**ユーザーストーリー:** Claude DesktopとClaude Codeの両方のユーザーとして、両方の環境で同じ機能を使いたい。どちらのツールを使っていても一貫したタスク管理ができるようにするため。

#### 受け入れ基準

1. MCPサーバーとしてデプロイされたとき、システムはClaude Desktopで動作すること
2. プラグインとしてデプロイされたとき、システムはClaude Codeで動作すること
3. どちらのプラットフォームを使用しても、システムは同一の機能を提供すること
4. 設定ファイルが存在するとき、両方のプラットフォームは同じ設定ファイルを使用すること
5. ツールが呼び出されたとき、両方のプラットフォームは同じ結果を返すこと

### 要件8: Notion統合

**ユーザーストーリー:** Notionユーザーとして、長期タスクを自動的にNotionデータベースに同期してもらいたい。好みのツールでプロジェクトを管理できるようにするため。

#### 受け入れ基準

1. タスクの期限が8日以上先のとき、システムはNotionに同期すること
2. Notionに同期するとき、システムは設定されたデータベースIDを使用すること
3. Notionページを作成するとき、システムはタイトル、優先度、期限、関係者を含めること
4. 同期が成功したとき、システムはNotionページURLを返すこと
5. 同期が失敗したとき、システムはエラー詳細を提供すること

### 要件9: Apple Reminders統合

**ユーザーストーリー:** Appleエコシステムユーザーとして、短期タスクをApple Remindersに追加してもらいたい。すべてのデバイスでネイティブ通知を受け取れるようにするため。

#### 受け入れ基準

1. タスクの期限が7日以内のとき、システムはApple Remindersを作成すること
2. リマインダーを作成するとき、システムはAppleScript統合を使用すること
3. リマインダーを設定するとき、システムは設定されたリマインダーリストを使用すること
4. リマインダーが作成されたとき、システムは適切な期限日とアラームを設定すること
5. 作成が失敗したとき、システムはエラー詳細を提供すること

### 要件10: 設定管理

**ユーザーストーリー:** 変化する設定を持つユーザーとして、設定を更新したい。システムが進化する作業パターンに適応できるようにするため。

#### 受け入れ基準

1. 設定の更新が必要なとき、システムは部分更新を許可すること
2. カレンダー設定を更新するとき、システムは勤務時間形式を検証すること
3. 優先度ルールを更新するとき、システムはルール構文を検証すること
4. 統合を更新するとき、システムはAPI接続をテストすること
5. 更新が保存されたとき、システムは変更成功を確認すること
6. 検証が失敗したとき、システムは具体的なエラーメッセージを提供すること

### 要件11: タスク分割と整理

**ユーザーストーリー:** 複雑なタスクや複数のタスクを一度に伝えるユーザーとして、システムに適切なサイズのタスクに分割してもらいたい。管理しやすく実行可能なタスクの集合にするため。

#### 受け入れ基準

1. ユーザーが複数のタスクを含む文章を提供したとき、システムは個別のタスクに分離すること
2. ユーザーが大きなタスクを提供したとき、システムは実行可能なサブタスクに分割すること
3. タスクを分割するとき、システムは各サブタスクが独立して実行可能であることを確認すること
4. タスクを分割するとき、システムは元のタスクの意図と目標を保持すること
5. 分割されたタスクには適切な順序や依存関係が設定されること
6. 分割結果をユーザーに提示するとき、システムは分割理由と推奨実行順序を説明すること
